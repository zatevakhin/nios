#-*- coding: utf-8 -*-

import logging

from nios.core.plugins.CPluginBase import CPluginBase
from nios.core.CNiosCore import CNiosCore
from nios.core.auxiliary import exception
from nios.core.data import CTask, ETaskPriority, ETaskType


SERVICE_VENDOR = "apache"
SERVICE_TYPE = "server"
ACTION_CLASS = "vulnerability-check"


class CApache(CPluginBase):

    mName = f'{SERVICE_VENDOR}-service'
    mTags = {SERVICE_TYPE, ACTION_CLASS, SERVICE_VENDOR}

    def __init__(self, core: CNiosCore):
        self.mCore = core

    def __call__(self, task: CTask):
        return task

    def onComplete(self, result):
        result.priority = ETaskPriority.HIGH
        result.type = ETaskType.WORK_FINISHED
        self.mCore.put(result)

    def onError(self, error):
        logging.exception(error)